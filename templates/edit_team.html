<!DOCTYPE html>
<html>
<head>
    <title>Edit Team</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='edit_team.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>
    <h2>Edit Team: {{ team[0] }}</h2>

    <form method="POST" id="editForm">
        <label>Leader Email:</label>
        <input type="email" name="leader_email" value="{{ team[0] }}" required>

        <div id="memberFields">
            <label>Members Email:</label>
            {% for m in members %}
                <div>
                    <input type="email" name="member_email" value="{{ m }}" placeholder="Member Email" required>
                    <button type="button" class="delete-btn" onclick="this.parentElement.remove()">X</button>
                </div>
            {% endfor %}
        </div>

        <button type="button" class="add-member-btn" onclick="addMemberField()">+ Add Another Member</button>

        <input type="submit" value="Update Team">
    </form>

    <div id="loading-message">
        <div class="text-center">
            <div class="spinner-border text-light" role="status"></div>
            <p class="mt-3">Please wait it take few seconds to edit....</p>
        </div>
    </div>

    <script>
        function addMemberField() {
            let div = document.getElementById("memberFields");
            let wrapper = document.createElement("div");

            let input = document.createElement("input");
            input.type = "email";
            input.name = "member_email";
            input.placeholder = "Member Email";
            input.required = true;

            let btn = document.createElement("button");
            btn.type = "button";
            btn.className = "delete-btn";
            btn.innerHTML = "X";
            btn.onclick = function() {
                wrapper.remove();
            };

            wrapper.appendChild(input);
            wrapper.appendChild(btn);
            div.appendChild(wrapper);
        }

        document.getElementById("editForm").addEventListener("submit", function(event) {
            event.preventDefault(); // stop immediate navigation
            document.getElementById("loading-message").style.display = "flex";
            setTimeout(() => {
                    event.target.submit();
                }, 200); 
        });
    </script>

</body>
</html>
